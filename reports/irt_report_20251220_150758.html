<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åº”æ€¥å“åº”æŠ¥å‘Š - 10.76.244.41</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            background: #f5f7fa;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        h1 {
            color: #1a1a1a;
            font-size: 2.5em;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 3px solid #4CAF50;
        }

        h2 {
            color: #2c3e50;
            font-size: 1.8em;
            margin-top: 40px;
            margin-bottom: 20px;
            padding-left: 10px;
            border-left: 4px solid #4CAF50;
        }

        h3 {
            color: #34495e;
            font-size: 1.3em;
            margin-top: 25px;
            margin-bottom: 15px;
        }

        .meta-info {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 6px;
            margin: 20px 0;
            border-left: 4px solid #2196F3;
        }

        .meta-info p {
            margin: 8px 0;
            font-size: 1.05em;
        }

        .meta-info strong {
            color: #2c3e50;
            display: inline-block;
            min-width: 100px;
        }

        .summary-box {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .summary-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 8px;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .summary-card.success {
            background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
        }

        .summary-card.failed {
            background: linear-gradient(135deg, #f44336 0%, #da190b 100%);
        }

        .summary-card .number {
            font-size: 2.5em;
            font-weight: bold;
            margin: 10px 0;
        }

        .summary-card .label {
            font-size: 1.1em;
            opacity: 0.95;
        }

        .step-card {
            background: #ffffff;
            border: 1px solid #e1e4e8;
            border-radius: 8px;
            padding: 25px;
            margin: 20px 0;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
        }

        .step-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 2px solid #f0f0f0;
        }

        .step-title {
            font-size: 1.3em;
            color: #2c3e50;
            font-weight: 600;
        }

        .status-badge {
            padding: 6px 16px;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: 600;
        }

        .status-badge.success {
            background: #d4edda;
            color: #155724;
        }

        .status-badge.failed {
            background: #f8d7da;
            color: #721c24;
        }

        .step-meta {
            display: flex;
            gap: 30px;
            margin: 15px 0;
            font-size: 0.95em;
            color: #666;
        }

        .step-meta span {
            display: flex;
            align-items: center;
        }

        .step-meta strong {
            margin-right: 8px;
            color: #333;
        }

        pre {
            background: #f6f8fa;
            border: 1px solid #e1e4e8;
            border-radius: 6px;
            padding: 16px;
            overflow-x: auto;
            font-family: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, monospace;
            font-size: 0.9em;
            line-height: 1.5;
            margin: 15px 0;
        }

        pre .highlight {
            background: #fff3cd;
            color: #856404;
            font-weight: bold;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
        }

        th {
            background: #f8f9fa;
            color: #2c3e50;
            font-weight: 600;
            text-align: left;
            padding: 12px 15px;
            border-bottom: 2px solid #dee2e6;
        }

        td {
            padding: 12px 15px;
            border-bottom: 1px solid #e1e4e8;
        }

        tr:hover {
            background: #f8f9fa;
        }

        .findings-section {
            background: #fff9e6;
            border-left: 4px solid #ff9800;
            padding: 20px;
            margin: 20px 0;
            border-radius: 6px;
        }

        .recommendations-section {
            background: #e8f5e9;
            border-left: 4px solid #4CAF50;
            padding: 20px;
            margin: 20px 0;
            border-radius: 6px;
        }

        ul {
            margin: 15px 0;
            padding-left: 30px;
        }

        li {
            margin: 10px 0;
            line-height: 1.8;
        }

        .analysis-item {
            background: #e3f2fd;
            border-left: 3px solid #2196F3;
            padding: 10px 15px;
            margin: 8px 0;
            border-radius: 4px;
        }

        .threat-intel-table {
            margin-top: 15px;
        }

        .malicious {
            color: #d32f2f;
            font-weight: bold;
        }

        .normal {
            color: #388e3c;
            font-weight: bold;
        }

        .footer {
            margin-top: 50px;
            padding-top: 20px;
            border-top: 2px solid #e1e4e8;
            text-align: center;
            color: #666;
            font-size: 0.9em;
        }

        @media print {
            body {
                background: white;
                padding: 0;
            }
            .container {
                box-shadow: none;
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ›¡ï¸ åº”æ€¥å“åº”æŠ¥å‘Š</h1>

        <div class="meta-info">
            <p><strong>ç”Ÿæˆæ—¶é—´:</strong> 2025-12-20 15:07:58</p>
            <p><strong>ç›®æ ‡ä¸»æœº:</strong> 10.76.244.41</p>
            <p><strong>æ“ä½œç³»ç»Ÿ:</strong> linux</p>
        </div>

        <div class="meta-info">
            <h2>ğŸ“‹ å¨èƒæè¿°</h2>
            <p>å¸¸è§„å®‰å…¨æ£€æŸ¥</p>
        </div>

        <h2>ğŸ“Š æ‰§è¡Œæ‘˜è¦</h2>
        <div class="summary-box">
            <div class="summary-card">
                <div class="label">æ€»æ­¥éª¤æ•°</div>
                <div class="number">8</div>
            </div>
            <div class="summary-card success">
                <div class="label">âœ… æˆåŠŸ</div>
                <div class="number">8</div>
            </div>
            <div class="summary-card failed">
                <div class="label">âŒ å¤±è´¥</div>
                <div class="number">0</div>
            </div>
        </div>

        <h2>ğŸ“ æ‰§è¡Œè¯¦æƒ…</h2>

        <div class="step-card">
            <div class="step-header">
                <h3 class="step-title">æ­¥éª¤ 1: check_processes</h3>
                <span class="status-badge success">âœ… æˆåŠŸ</span>
            </div>

            <div class="step-meta">
                <span><strong>æ—¶é—´:</strong> 2025-12-20T15:05:28.996107</span>
                <span><strong>é€€å‡ºç :</strong> 0</span>
            </div>

            <h4>æ ‡å‡†è¾“å‡º:</h4>
            <pre>==========================================
è¿›ç¨‹æ£€æŸ¥ - 2025å¹´ 12æœˆ 20æ—¥ æ˜ŸæœŸå…­ 15:05:07 CST
==========================================

[*] æ£€æŸ¥é«˜CPUå ç”¨è¿›ç¨‹ (&gt;70%)...
  USER         PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
  root      151052  3.7  0.5  18120 10860 ?        Ss   15:05   0:00 sshd-session: root [priv]
  root        1905  2.6 19.1 5185744 378840 ?      Ssl  04:44  16:38 /usr/bin/gnome-shell
  root        1416  0.7  1.6 2277036 32668 ?       Ssl  04:43   4:21 /usr/sbin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock
  root        1688  0.6  3.5 384224 71056 tty2     Sl+  04:43   3:48 /usr/lib/xorg/Xorg vt2 -displayfd 3 -auth /run/user/0/gdm/Xauthority -nolisten tcp -background none -noreset -keeptty -novtswitch -verbose 3
  root          67  0.1  0.0      0     0 ?        S    04:43   1:13 [kswapd0]
  root        2115  0.1  0.6 464920 12280 ?        Sl   04:44   0:54 /usr/bin/vmtoolsd -n vmusr --blockFd 3
  root         655  0.1  0.2 252928  4312 ?        Ssl  04:43   0:47 /usr/bin/vmtoolsd
  root         818  0.1  0.8 1872564 17484 ?       Ssl  04:43   0:37 /usr/bin/containerd
  root           1  0.0  0.4  23680  8716 ?        Ss   04:43   0:26 /sbin/init splash
  root      126590  0.0  0.0      0     0 ?        I    14:06   0:02 [kworker/1:0-ata_sff]
  root      126592  0.0  0.0      0     0 ?        I    14:07   0:02 [kworker/2:0-ata_sff]
  root      134489  0.0  0.0      0     0 ?        I    14:28   0:01 [kworker/1:2-events]
  root        3327  0.0  1.3 811632 27416 ?        Ssl  04:56   0:19 /usr/libexec/gnome-terminal-server
  root        1662  0.0  0.4  94752  8048 ?        S&lt;sl 04:43   0:18 /usr/bin/pipewire

[*] æ£€æŸ¥é«˜å†…å­˜å ç”¨è¿›ç¨‹ (&gt;50%)...
USER         PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
root        1905  2.6 19.1 5185744 378840 ?      Ssl  04:44  16:38 /usr/bin/gnome-shell
root        1688  0.6  3.5 384224 71056 tty2     Sl+  04:43   3:48 /usr/lib/xorg/Xorg vt2 -displayfd 3 -auth /run/user/0/gdm/Xauthority  (è¾“å‡ºè¿‡é•¿å·²æˆªæ–­)</pre>

        </div>

        <div class="step-card">
            <div class="step-header">
                <h3 class="step-title">æ­¥éª¤ 2: check_network</h3>
                <span class="status-badge success">âœ… æˆåŠŸ</span>
            </div>

            <div class="step-meta">
                <span><strong>æ—¶é—´:</strong> 2025-12-20T15:05:43.586540</span>
                <span><strong>é€€å‡ºç :</strong> 0</span>
            </div>

            <h4>æ ‡å‡†è¾“å‡º:</h4>
            <pre>==========================================
ç½‘ç»œè¿æ¥æ£€æŸ¥ - 2025å¹´ 12æœˆ 20æ—¥ æ˜ŸæœŸå…­ 15:05:17 CST
==========================================

[*] æ£€æŸ¥ç›‘å¬ç«¯å£...
Active Internet connections (only servers)
Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name    
tcp        0      0 127.0.0.1:34687         0.0.0.0:*               LISTEN      818/containerd      
tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      4731/sshd: /usr/sbi 
tcp6       0      0 :::1716                 :::*                    LISTEN      2054/kdeconnectd    
tcp6       0      0 :::22                   :::*                    LISTEN      4731/sshd: /usr/sbi 
udp        0      0 0.0.0.0:53575           0.0.0.0:*                           2054/kdeconnectd    
udp        0      0 0.0.0.0:33390           0.0.0.0:*                           2857/python3        
udp        0      0 10.76.244.41:3702       0.0.0.0:*                           2857/python3        
udp        0      0 239.255.255.250:3702    0.0.0.0:*                           2857/python3        
udp        0      0 172.18.0.1:3702         0.0.0.0:*                           2857/python3        
udp        0      0 239.255.255.250:3702    0.0.0.0:*                           2857/python3        
udp        0      0 172.17.0.1:3702         0.0.0.0:*                           2857/python3        
udp        0      0 239.255.255.250:3702    0.0.0.0:*                           2857/python3        
udp        0      0 0.0.0.0:58041           0.0.0.0:*                           2857/python3        
udp        0      0 0.0.0.0:46812           0.0.0.0:*                           2054/kdeconnectd    
udp        0      0 0.0.0.0:60284           0.0.0.0:*                           2857/python3        
udp        0      0 0.0.0.0:35876           0.0.0.0:*                           2054/kdeconnectd    
udp6       0      0 :::53800                :::*                                2054/kdeconnectd    (è¾“å‡ºè¿‡é•¿å·²æˆªæ–­)</pre>

            <h4>åˆ†æç»“æœ:</h4>

            <div class="analysis-item">å‘ç° 4 ä¸ªæ´»åŠ¨è¿æ¥</div>

        </div>

        <div class="step-card">
            <div class="step-header">
                <h3 class="step-title">æ­¥éª¤ 3: check_backdoor_signatures</h3>
                <span class="status-badge success">âœ… æˆåŠŸ</span>
            </div>

            <div class="step-meta">
                <span><strong>æ—¶é—´:</strong> 2025-12-20T15:05:56.627978</span>
                <span><strong>é€€å‡ºç :</strong> 0</span>
            </div>

            <h4>æ ‡å‡†è¾“å‡º:</h4>
            <pre>==========================================
åé—¨ç‰¹å¾æ£€æµ‹ - 2025å¹´ 12æœˆ 20æ—¥ æ˜ŸæœŸå…­ 15:05:34 CST
==========================================

[*] æ£€æµ‹Meterpreterç‰¹å¾...
  [*] æ£€æŸ¥é»˜è®¤ç«¯å£ (4444, 4445, 5555, 6666)...
  [*] æ£€æŸ¥Meterpreterè¿›ç¨‹åç§°...
  [*] æ£€æŸ¥åå‘Shellå‘½ä»¤...

[*] æ£€æµ‹Cobalt Strikeç‰¹å¾...
  [*] æ£€æŸ¥CSé»˜è®¤ç«¯å£ (50050)...
  [*] æ£€æŸ¥Beaconè¿›ç¨‹...

[*] æ£€æµ‹WebShellæ–‡ä»¶...
<span class="highlight">>> [!]   [*] æ‰«æWebç›®å½•ä¸­çš„å¯ç–‘PHP/JSP/ASPXæ–‡ä»¶...</span>

[*] æ£€æµ‹æŒ–çŸ¿ç¨‹åº...
  [*] æ£€æŸ¥æŒ–çŸ¿è¿›ç¨‹å...
  [*] æ£€æŸ¥çŸ¿æ± è¿æ¥...
  [*] æ£€æŸ¥stratumåè®®...

[*] æ£€æµ‹Rootkitç‰¹å¾...
<span class="highlight">>> [!]   [*] æ£€æŸ¥/dev/shmä¸­çš„å¯ç–‘æ–‡ä»¶...</span>
<span class="highlight">>> [!]   [!] å¯ç–‘ - /dev/shmä¸­çš„æ–‡ä»¶: æ€»è®¡ 4</span>
<span class="highlight">>> [!]   [!] å¯ç–‘ - /dev/shmä¸­çš„æ–‡ä»¶: -rw-r--r--  1 root root   32 11æœˆ17æ—¥ 16:29 sem.haveged_sem</span>
  [*] æ£€æŸ¥/tmpä¸­çš„éšè—å¯æ‰§è¡Œæ–‡ä»¶...
  [*] æ£€æŸ¥LD_PRELOADåŠ«æŒ...

[*] æ£€æµ‹æŒä¹…åŒ–æœºåˆ¶...
<span class="highlight">>> [!]   [*] æ£€æŸ¥crontabä¸­çš„å¯ç–‘ä»»åŠ¡...</span>
  [*] æ£€æŸ¥ç³»ç»Ÿçº§crontab...
  [*] æ£€æŸ¥systemdæœåŠ¡...
  [*] æ£€æŸ¥.bashrc/.bash_profileæŒä¹…åŒ–...

[*] æ£€æµ‹SSHåé—¨...
  [*] æ£€æŸ¥authorized_keys...
<span class="highlight">>> [!]   [!] å¯ç–‘ - å¯ç–‘SSHå¯†é’¥: command=&quot;git-shell -c &quot;$SSH_ORIGINAL_COMMAND&quot;&quot; ssh-rsa AAAAB3NzaC1yc2EAAAADAQABA...</span>
<span class="highlight">>> [!]   [*] æ£€æŸ¥SSHé…ç½®å¼‚å¸¸...</span>
  [!] è­¦å‘Š - Rootç™»å½•å·²å¯ç”¨
  [*] ä¿¡æ¯ - å¯†ç è®¤è¯å·²å¯ç”¨

[*] æ£€æµ‹è¿›ç¨‹æ³¨å…¥ç‰¹å¾...
<span class="highlight">>> [!]   [*] æ£€æŸ¥å¯ç–‘çš„å†…å­˜æ˜ å°„...</span>

<span class="highlight">>> [!] [*] æ£€æµ‹å¼‚å¸¸ç½‘ç»œç›‘å¬...</span>
  [*] éæ ‡å‡†ç«¯å£ç›‘å¬...
<span class="highlight">>> [!]   [!] å¯ç–‘ - éæ ‡å‡†ç«¯å£ç›‘å¬: :::1716 (2054/kdeconnectd)</span>

==========================================
åé—¨ç‰¹å¾æ£€æµ‹å®Œæˆ
æ—¶é—´: 2025å¹´ 12æœˆ 20æ—¥ æ˜ŸæœŸå…­ 15:05:35 CST
==========================================
</pre>

        </div>

        <div class="step-card">
            <div class="step-header">
                <h3 class="step-title">æ­¥éª¤ 4: check_user_security</h3>
                <span class="status-badge success">âœ… æˆåŠŸ</span>
            </div>

            <div class="step-meta">
                <span><strong>æ—¶é—´:</strong> 2025-12-20T15:06:04.950237</span>
                <span><strong>é€€å‡ºç :</strong> 0</span>
            </div>

            <h4>æ ‡å‡†è¾“å‡º:</h4>
            <pre>==========================================
ç”¨æˆ·æƒé™å®‰å…¨æ£€æµ‹ - 2025å¹´ 12æœˆ 20æ—¥ æ˜ŸæœŸå…­ 15:05:43 CST
==========================================

[*] æ£€æµ‹å½±å­ç”¨æˆ·ï¼ˆUID=0çš„érootç”¨æˆ·ï¼‰...
  [+] æ­£å¸¸ - root ç”¨æˆ·

<span class="highlight">>> [!] [*] æ£€æµ‹å¯ç–‘çš„ç³»ç»Ÿç”¨æˆ·...</span>
<span class="highlight">>> [!]   [!] å¯ç–‘ - ç³»ç»Ÿç”¨æˆ·æœ‰ç™»å½•shell: sync (UID:4, Shell:/bin/sync)</span>
<span class="highlight">>> [!]   [!] å¯ç–‘ - ç³»ç»Ÿç”¨æˆ·æœ‰ç™»å½•shell: postgres (UID:116, Shell:/bin/bash)</span>

[*] æ£€æµ‹æœ€è¿‘åˆ›å»ºçš„ç”¨æˆ·ï¼ˆ7å¤©å†…ï¼‰...
  [*] æœªæ‰¾åˆ°ç”¨æˆ·æ“ä½œæ—¥å¿—æ–‡ä»¶

[*] æ£€æµ‹ç©ºå¯†ç ç”¨æˆ·...

[*] æ£€æµ‹sudoæƒé™ç”¨æˆ·...
  [*] /etc/sudoers ä¸­çš„é…ç½®:
    root	ALL=(ALL:ALL) ALL
    %sudo	ALL=(ALL:ALL) ALL
  [*] /etc/sudoers.d/ ä¸­çš„é…ç½®:
    æ–‡ä»¶: /etc/sudoers.d/kali-grant-root
      %kali-trusted   ALL=(ALL:ALL) NOPASSWD: ALL
    æ–‡ä»¶: /etc/sudoers.d/ospd-openvas
      _gvm ALL = NOPASSWD: /usr/sbin/openvas
    æ–‡ä»¶: /etc/sudoers.d/README
  [*] sudo/wheel ç»„æˆå‘˜:
kali

<span class="highlight">>> [!] [*] æ£€æµ‹å¼‚å¸¸ç”¨æˆ·homeç›®å½•...</span>

<span class="highlight">>> [!] [*] æ£€æµ‹å¼‚å¸¸çš„ç”¨æˆ·shell...</span>

[*] æ£€æµ‹ç”¨æˆ·SSHé…ç½®...
  [*] æ£€æŸ¥ç”¨æˆ· .ssh çš„SSHé…ç½®: /root/.ssh

[*] æ£€æµ‹æœ€è¿‘ç™»å½•æ´»åŠ¨...
  [*] æœ€è¿‘10æ¬¡æˆåŠŸç™»å½•:

<span class="highlight">>> [!]   [*] æœ€è¿‘10æ¬¡å¤±è´¥ç™»å½•:</span>

[*] æ£€æµ‹å½“å‰ç™»å½•ç”¨æˆ·...
  15:05:43 up 10:21,  3 users,  load average: 0.09, 0.15, 0.24
  USER     TTY      æ¥è‡ª           LOGIN@   IDLE   JCPU   PCPU WHAT
  root              10.76.244.252    15:05   40:35   0.00s  0.01s sshd-session: root [priv]
  root     tty2     -                1711æœˆ25 32days  3:48   0.06s /usr/libexec/gnome-session-binary
  root              -                1711æœˆ25 40:35   0.00s  2.29s /usr/lib/systemd/systemd --user

[*] æ£€æµ‹å¯†ç ç­–ç•¥...
  [*] å¯†ç è¿‡æœŸç­–ç•¥:
PASS_MAX_DAYS	99999
PASS_MIN_DAYS	0
PASS_WARN_AGE	7
  [*] PAMå¯†ç ç­–ç•¥:

<span class="highlight">>> [!] [*] æ£€æµ‹ç»„æƒé™å¼‚å¸¸...</span>
  [*] æ•æ„Ÿç»„çš„æˆå‘˜:
    sudo: kali
    adm: kali

[*] æ£€æµ‹ç”¨æˆ·æ–‡ä»¶å®Œæ•´æ€§...
  /etc/passwd MD5: 71190de96bfaee222362a1da2f0f22bd
  /etc/shadow MD5: 441a3e7a87a3206f52bea4e32ad98e24
  /etc/passwd æƒé™: 644
  /etc/shadow æƒé™: 640
<span class="highlight">>> [!]   [!] è­¦å‘Š - /etc/shadow æƒé™å¼‚å¸¸ï¼ˆåº”ä¸º000/400/600ï¼‰</span>

[*] æ£€æµ‹ç”¨æˆ·crontabä»»åŠ¡...

[*] æ£€æµ‹å†å²å‘½ä»¤ä¸­çš„æ•æ„Ÿæ“ä½œ...
  [*] æ£€æŸ¥ root çš„å†å²å‘½ä»¤: /root/.zsh_history
<span class="highlight">>> [!]     [!] å¯ç–‘å‘½ä»¤: chmod 777 rip-hg.pl</span>
<span class="highlight">>> [!]     [!] å¯ç–‘å‘½ä»¤: chmod 777 rip-svn.pl</span>
<span class="highlight">>> [!]     [!] å¯ç–‘å‘½ä»¤: curl -fsSL https://download.docker.com/linux/debian/gpg | sudo gpg --dearmor -o /usr/share/keyrings/docker-archive-keyring.gpgcurl -fsSL https://download.docker.com/</span> (è¾“å‡ºè¿‡é•¿å·²æˆªæ–­)</pre>

            <h4>é”™è¯¯è¾“å‡º:</h4>
            <pre>/tmp/irt_check_user_security.sh: è¡Œ 167: last: æœªæ‰¾åˆ°å‘½ä»¤
</pre>

        </div>

        <div class="step-card">
            <div class="step-header">
                <h3 class="step-title">æ­¥éª¤ 5: check_persistence</h3>
                <span class="status-badge success">âœ… æˆåŠŸ</span>
            </div>

            <div class="step-meta">
                <span><strong>æ—¶é—´:</strong> 2025-12-20T15:06:16.485495</span>
                <span><strong>é€€å‡ºç :</strong> 0</span>
            </div>

            <h4>æ ‡å‡†è¾“å‡º:</h4>
            <pre>==========================================
æŒä¹…åŒ–æœºåˆ¶å…¨é¢æ£€æµ‹ - 2025å¹´ 12æœˆ 20æ—¥ æ˜ŸæœŸå…­ 15:05:54 CST
==========================================

[1] æ£€æµ‹ Alias å‘½ä»¤åŠ«æŒåé—¨...
------------------------------------------------------------
  [*] æ£€æŸ¥ç³»ç»Ÿçº§åˆ«çš„aliasé…ç½®...
  [*] æ£€æŸ¥ç”¨æˆ·çº§åˆ«çš„aliasé…ç½®...
    ç”¨æˆ·: root, æ–‡ä»¶: .bashrc
<span class="highlight">>> [!]       [!] å¯ç–‘ - alias ls=&#x27;ls --color=auto&#x27;</span>
      alias grep=&#x27;grep --color=auto&#x27;
      alias fgrep=&#x27;fgrep --color=auto&#x27;
      alias egrep=&#x27;egrep --color=auto&#x27;
      alias diff=&#x27;diff --color=auto&#x27;
      alias ip=&#x27;ip --color=auto&#x27;
      alias ll=&#x27;ls -l&#x27;
      alias la=&#x27;ls -A&#x27;
      alias l=&#x27;ls -CF&#x27;
    ç”¨æˆ·: root, æ–‡ä»¶: .zshrc
      alias history=&quot;history 0&quot;
<span class="highlight">>> [!]       [!] å¯ç–‘ - alias ls=&#x27;ls --color=auto&#x27;</span>
      alias grep=&#x27;grep --color=auto&#x27;
      alias fgrep=&#x27;fgrep --color=auto&#x27;
      alias egrep=&#x27;egrep --color=auto&#x27;
      alias diff=&#x27;diff --color=auto&#x27;
      alias ip=&#x27;ip --color=auto&#x27;
      alias ll=&#x27;ls -l&#x27;
      alias la=&#x27;ls -A&#x27;
      alias l=&#x27;ls -CF&#x27;
    ç”¨æˆ·: kali, æ–‡ä»¶: .bashrc
<span class="highlight">>> [!]       [!] å¯ç–‘ - alias ls=&#x27;ls --color=auto&#x27;</span>
      alias grep=&#x27;grep --color=auto&#x27;
      alias fgrep=&#x27;fgrep --color=auto&#x27;
      alias egrep=&#x27;egrep --color=auto&#x27;
      alias diff=&#x27;diff --color=auto&#x27;
      alias ip=&#x27;ip --color=auto&#x27;
      alias ll=&#x27;ls -l&#x27;
      alias la=&#x27;ls -A&#x27;
      alias l=&#x27;ls -CF&#x27;
    ç”¨æˆ·: kali, æ–‡ä»¶: .zshrc
      alias history=&quot;history 0&quot;
<span class="highlight">>> [!]       [!] å¯ç–‘ - alias ls=&#x27;ls --color=auto&#x27;</span>
      alias grep=&#x27;grep --color=auto&#x27;
      alias fgrep=&#x27;fgrep --color=auto&#x27;
      alias egrep=&#x27;egrep --color=auto&#x27;
      alias diff=&#x27;diff --color=auto&#x27;
      alias ip=&#x27;ip --color=auto&#x27;
      alias ll=&#x27;ls -l&#x27;
      alias la=&#x27;ls -A&#x27;
      alias l=&#x27;ls -CF&#x27;

[2] æ£€æµ‹ PAM (Pluggable Authentication Modules) åé—¨...
------------------------------------------------------------
  [*] æ£€æŸ¥ PAM é…ç½®æ–‡ä»¶...
<span class="highlight">>> [!]     [!] å¯ç–‘PAMæ¨¡å— in common-account:</span>
      account	[success=1 new_authtok_reqd=done default=ignore]	pam_winbind.so
<span class="highlight">>> [!]     [!] å¯ç–‘PAMæ¨¡å— in common-auth:</span>
      auth	[success=1 default=ignore]	pam_winbind.so krb5_auth krb5_ccache_type=FILE cached_login try_first_ (è¾“å‡ºè¿‡é•¿å·²æˆªæ–­)</pre>

        </div>

        <div class="step-card">
            <div class="step-header">
                <h3 class="step-title">æ­¥éª¤ 6: check_system_integrity</h3>
                <span class="status-badge success">âœ… æˆåŠŸ</span>
            </div>

            <div class="step-meta">
                <span><strong>æ—¶é—´:</strong> 2025-12-20T15:07:05.470883</span>
                <span><strong>é€€å‡ºç :</strong> 0</span>
            </div>

            <h4>æ ‡å‡†è¾“å‡º:</h4>
            <pre>==========================================
ç³»ç»Ÿå®Œæ•´æ€§æ£€æŸ¥ - 2025å¹´ 12æœˆ 20æ—¥ æ˜ŸæœŸå…­ 15:06:05 CST
==========================================

<span class="highlight">>> [!] [1] æ£€æµ‹å¯ç–‘ä½ç½®çš„ELFå¯æ‰§è¡Œæ–‡ä»¶...</span>
------------------------------------------------------------
  [*] æ£€æŸ¥ä¸´æ—¶ç›®å½•ä¸­çš„ELFæ–‡ä»¶...
    ç›®å½•: /tmp
<span class="highlight">>> [!]       [!] å¯ç–‘ELFæ–‡ä»¶: /tmp/shell.elf</span>
-rwxrwxrwx 1 root root 250 12æœˆ15æ—¥ 14:09 /tmp/shell.elf
/tmp/shell.elf: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), statically linked, no section header
    ç›®å½•: /dev/shm
    ç›®å½•: /var/tmp

[2] æ£€æµ‹éšè—çš„ELFæ–‡ä»¶ï¼ˆä»¥.å¼€å¤´ï¼‰...
------------------------------------------------------------
  [*] æ£€æŸ¥ç›®å½•: /tmp
  [*] æ£€æŸ¥ç›®å½•: /dev/shm
  [*] æ£€æŸ¥ç›®å½•: /var/tmp
  [*] æ£€æŸ¥ç›®å½•: /home
  [*] æ£€æŸ¥ç›®å½•: /root

[3] æ£€æµ‹å…³é”®ç³»ç»Ÿå‘½ä»¤çš„å®Œæ•´æ€§...
------------------------------------------------------------
  [*] æ£€æŸ¥å…³é”®å‘½ä»¤...
    [!] è­¦å‘Š - service æ˜¯è„šæœ¬è€ŒéäºŒè¿›åˆ¶: /usr/sbin/service
        ç±»å‹:  POSIX shell script, ASCII text executable, with very long lines (459)
    [!] è­¦å‘Š - firewalld æ˜¯è„šæœ¬è€ŒéäºŒè¿›åˆ¶: /usr/sbin/firewalld
        ç±»å‹:  Python script, ASCII text executable

<span class="highlight">>> [!] [4] æ£€æµ‹å¯ç–‘çš„SUID/SGIDæ–‡ä»¶...</span>
------------------------------------------------------------
  [*] æŸ¥æ‰¾SUIDæ–‡ä»¶ï¼ˆæœ€è¿‘7å¤©ä¿®æ”¹ï¼‰...
  [*] æŸ¥æ‰¾SGIDæ–‡ä»¶ï¼ˆæœ€è¿‘7å¤©ä¿®æ”¹ï¼‰...
<span class="highlight">>> [!]   [*] æ£€æŸ¥å¯ç–‘ä½ç½®çš„SUID/SGIDæ–‡ä»¶...</span>

[5] æ£€æµ‹æ— æ‰€æœ‰è€…çš„æ–‡ä»¶ï¼ˆå¯èƒ½æ˜¯æ”»å‡»è€…åˆ é™¤è´¦æˆ·åé—ç•™ï¼‰...
------------------------------------------------------------
  [*] æŸ¥æ‰¾æ— æ‰€æœ‰è€…çš„æ–‡ä»¶...
    [!] æ— æ‰€æœ‰è€…æ–‡ä»¶: /var/lib/docker/overlay2/9360f4e52f740159a5e01f8ccf61950ccb3e4002e723440e3bb36efcc43829a0/diff/usr/local/bin/caido-cli
-rwxr-xr-x 1 1001 1001 147M 2025å¹´ 5æœˆ14æ—¥ /var/lib/docker/overlay2/9360f4e52f740159a5e01f8ccf61950ccb3e4002e723440e3bb36efcc43829a0/diff/usr/local/bin/caido-cli
      ç±»å‹: ELFå¯æ‰§è¡Œæ–‡ä»¶
    [!] æ— æ‰€æœ‰è€…æ–‡ä»¶: /root/.cpan/build/DBD-SQLite-1.76-0/constants.inc
-rw-r--r-- 1 1001 1001 39K 2024å¹´ 9æœˆ17æ—¥ /root/.cpan/build/DBD-SQLite-1.76-0/constants.inc
    [!] æ— æ‰€æœ‰è€…æ–‡ä»¶: /root/.cpan/build/DBD-SQLite-1.76-0/Changes
-rw-r--r-- 1 1001 1001 52K 2024å¹´10æœˆ19æ—¥ /root/.cpan/build/DBD-SQLite-1.76-0/Changes
    [!] æ— æ‰€æœ‰è€…æ–‡ä»¶: /root/.cpan/build/DBD-SQLite-1.76-0/typemap
-rw-r--r-- 1 1001 1001 664 2024å¹´ 1æœˆ21æ—¥ /root/.cpan/build/DB (è¾“å‡ºè¿‡é•¿å·²æˆªæ–­)</pre>

            <h4>æ–‡ä»¶å¨èƒæƒ…æŠ¥åˆ†æ:</h4>
            <table class="threat-intel-table">
                <thead>
                    <tr>
                        <th>æ–‡ä»¶è·¯å¾„</th>
                        <th>SHA256ï¼ˆå‰16ä½ï¼‰</th>
                        <th>å¨èƒåˆ†æ•°</th>
                        <th>çŠ¶æ€</th>
                        <th>æ£€å‡ºç‡</th>
                        <th>æ¥æº</th>
                    </tr>
                </thead>
                <tbody>

                    <tr>
                        <td>/tmp/shell.elf</td>
                        <td><code>179fa7b1207e7a06...</code></td>
                        <td>52</td>
                        <td class="malicious">ğŸ”´ æ¶æ„</td>
                        <td>34/65</td>
                        <td>VirusTotal (Upload)</td>
                    </tr>

                </tbody>
            </table>

            <h4>æ¶æ„æ–‡ä»¶è¯¦ç»†åˆ†æ:</h4>

            <div class="file-detail">
                <h5>/tmp/shell.elf</h5>
                <p><strong>SHA256:</strong> <code>179fa7b1207e7a06e5a9e7fcf80ccc751a8ef1e04608b55d468c5d0cdf61a4b7</code></p>
                <p><strong>å¨èƒåˆ†æ•°:</strong> 52/100</p>
                <p><strong>çŠ¶æ€:</strong> <span class="malicious">ğŸ”´ æ¶æ„</span></p>

                <p><strong>æ–‡ä»¶ç±»å‹:</strong> Unknown</p>
                <p><strong>VirusTotalæ£€å‡ºç‡:</strong> 34/65 (52%)</p>

                <p><strong>å»ºè®®:</strong> <span class="malicious">ç«‹å³éš”ç¦»å¹¶åˆ é™¤è¯¥æ–‡ä»¶ï¼Œæ£€æŸ¥ç³»ç»Ÿæ˜¯å¦å­˜åœ¨å…¶ä»–æ¶æ„æ–‡ä»¶</span></p>
            </div>

        </div>

        <div class="step-card">
            <div class="step-header">
                <h3 class="step-title">æ­¥éª¤ 7: check_cron</h3>
                <span class="status-badge success">âœ… æˆåŠŸ</span>
            </div>

            <div class="step-meta">
                <span><strong>æ—¶é—´:</strong> 2025-12-20T15:07:15.122735</span>
                <span><strong>é€€å‡ºç :</strong> 0</span>
            </div>

            <h4>æ ‡å‡†è¾“å‡º:</h4>
            <pre>==========================================
è®¡åˆ’ä»»åŠ¡æ£€æŸ¥ - 2025å¹´ 12æœˆ 20æ—¥ æ˜ŸæœŸå…­ 15:06:53 CST
==========================================

[*] æ£€æŸ¥ç³»ç»Ÿcrontab (/etc/crontab)...
# /etc/crontab: system-wide crontab
# Unlike any other crontab you don&#x27;t have to run the `crontab&#x27;
# command to install the new version when you edit this file
# and files in /etc/cron.d. These files also have username fields,
# that none of the other crontabs do.

SHELL=/bin/sh
PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin

# Example of job definition:
# .---------------- minute (0 - 59)
# |  .------------- hour (0 - 23)
# |  |  .---------- day of month (1 - 31)
# |  |  |  .------- month (1 - 12) OR jan,feb,mar,apr ...
# |  |  |  |  .---- day of week (0 - 6) (Sunday=0 or 7) OR sun,mon,tue,wed,thu,fri,sat
# |  |  |  |  |
# *  *  *  *  * user-name command to be executed
17 *	* * *	root	cd / &amp;&amp; run-parts --report /etc/cron.hourly
25 6	* * *	root	test -x /usr/sbin/anacron || { cd / &amp;&amp; run-parts --report /etc/cron.daily; }
47 6	* * 7	root	test -x /usr/sbin/anacron || { cd / &amp;&amp; run-parts --report /etc/cron.weekly; }
52 6	1 * *	root	test -x /usr/sbin/anacron || { cd / &amp;&amp; run-parts --report /etc/cron.monthly; }
#

[*] æ£€æŸ¥ /etc/cron.d/ ç›®å½•...
æ€»è®¡ 36
drwxr-xr-x   2 root root  4096 2025å¹´ 4æœˆ25æ—¥ .
drwxr-xr-x 198 root root 12288 12æœˆ20æ—¥ 14:21 ..
-rw-r--r--   1 root root   188 2025å¹´ 1æœˆ 1æ—¥ e2scrub_all
-rw-r--r--   1 root root   607 2024å¹´ 9æœˆ18æ—¥ john
-rw-r--r--   1 root root   712 2024å¹´12æœˆ 4æ—¥ php
-rw-r--r--   1 root root   102 2025å¹´ 2æœˆ 6æ—¥ .placeholder
-rw-r--r--   1 root root   400 2024å¹´ 1æœˆ16æ—¥ sysstat

--- /etc/cron.d/e2scrub_all ---
30 3 * * 0 root test -e /run/systemd/system || SERVICE_MODE=1 /usr/libexec/e2fsprogs/e2scrub_all_cron
10 3 * * * root test -e /run/systemd/system || SERVICE_MODE=1 /sbin/e2scrub_all -A -r

--- /etc/cron.d/john ---
#
# Start john everyday at the same to try to crack the passwords. The
# second line will then later stop the process so that it doesn&#x27;t
# consume system resources that (è¾“å‡ºè¿‡é•¿å·²æˆªæ–­)</pre>

        </div>

        <div class="step-card">
            <div class="step-header">
                <h3 class="step-title">æ­¥éª¤ 8: check_logs</h3>
                <span class="status-badge success">âœ… æˆåŠŸ</span>
            </div>

            <div class="step-meta">
                <span><strong>æ—¶é—´:</strong> 2025-12-20T15:07:22.299706</span>
                <span><strong>é€€å‡ºç :</strong> 0</span>
            </div>

            <h4>æ ‡å‡†è¾“å‡º:</h4>
            <pre>==========================================
æ—¥å¿—æ£€æŸ¥ - 2025å¹´ 12æœˆ 20æ—¥ æ˜ŸæœŸå…­ 15:07:01 CST
==========================================

<span class="highlight">>> [!] [*] æ£€æŸ¥æœ€è¿‘çš„è®¤è¯å¤±è´¥ (æœ€å50æ¡)...</span>

[*] æ£€æŸ¥æˆåŠŸçš„SSHç™»å½• (æœ€å30æ¡)...

[*] æ£€æŸ¥rootç”¨æˆ·ç™»å½•...

[*] æ£€æŸ¥sudoå‘½ä»¤æ‰§è¡Œ (æœ€å30æ¡)...

[*] æ£€æŸ¥ç”¨æˆ·æ·»åŠ /åˆ é™¤...

[*] æ£€æŸ¥å‡Œæ™¨æ—¶æ®µç™»å½• (02:00-05:59)...

<span class="highlight">>> [!] [*] æ£€æŸ¥æš´åŠ›ç ´è§£è¿¹è±¡ (åŒä¸€IPå¤±è´¥æ¬¡æ•°)...</span>

[*] æ£€æŸ¥ç³»ç»Ÿæ—¥å¿—é”™è¯¯ (æœ€å20æ¡)...
<span class="highlight">>> [!] 12æœˆ 15 10:45:53 kali sshd-session[22808]: pam_winbind(sshd:auth): internal module error (retval = PAM_AUTHINFO_UNAVAIL(9), user = &#x27;root&#x27;)</span>
12æœˆ 15 13:54:20 kali systemd-networkd-wait-online[86459]: Timeout occurred while waiting for network connectivity.
12æœˆ 17 10:02:48 kali systemd-networkd-wait-online[88882]: Timeout occurred while waiting for network connectivity.
12æœˆ 17 10:02:49 kali systemd-networkd-wait-online[88919]: Timeout occurred while waiting for network connectivity.
12æœˆ 17 17:13:42 kali kernel: Bluetooth: hci0: unexpected cc 0x0c12 length: 2 &lt; 3
<span class="highlight">>> [!] 12æœˆ 17 17:13:42 kali kernel: Bluetooth: hci0: Opcode 0x0c12 failed: -38</span>
<span class="highlight">>> [!] 12æœˆ 17 17:13:55 kali gdm-password][107006]: pam_unix(gdm-password:auth): conversation failed</span>
12æœˆ 17 17:13:55 kali gdm-password][107006]: pam_unix(gdm-password:auth): auth could not identify password for [root]
12æœˆ 17 17:13:55 kali gdm-password][107006]: pam_winbind(gdm-password:auth): Could not retrieve user&#x27;s password
12æœˆ 18 10:02:45 kali systemd-networkd-wait-online[120291]: Timeout occurred while waiting for network connectivity.
12æœˆ 18 12:11:21 kali kernel: Bluetooth: hci0: unexpected cc 0x0c12 length: 2 &lt; 3
<span class="highlight">>> [!] 12æœˆ 18 12:11:21 kali kernel: Bluetooth: hci0: Opcode 0x0c12 failed: -38</span>
<span class="highlight">>> [!] 12æœˆ 18 12:11:28 kali gdm-password][124416]: pam_unix(gdm-password:auth): conversation failed</span>
12æœˆ 18 12:11:41 kali systemd-networkd-wait-online[124169]: Timeout occurred while waiting for network connectivity.
12æœˆ 18 22:23:00 kali kernel: Bluetooth: hci0: unexpected cc 0x0c12 length: 2 &lt; 3
<span class="highlight">>> [!] 12æœˆ 18 22:23:00 kali kernel: Bluetooth: hci0: Opcode 0x0c12 failed: -38</span>
12æœˆ 19 11:05:53 kali systemd-networkd-wait-online[126855]: Timeout occurred while waiti (è¾“å‡ºè¿‡é•¿å·²æˆªæ–­)</pre>

            <h4>é”™è¯¯è¾“å‡º:</h4>
            <pre>/tmp/irt_check_logs.sh: è¡Œ 104: last: æœªæ‰¾åˆ°å‘½ä»¤
/tmp/irt_check_logs.sh: è¡Œ 116: lastlog: æœªæ‰¾åˆ°å‘½ä»¤
</pre>

            <h4>åˆ†æç»“æœ:</h4>

            <div class="analysis-item">âš ï¸ å‘ç°ç™»å½•å¤±è´¥è®°å½•</div>

            <div class="analysis-item">å‘ç°ç®¡ç†å‘˜è´¦æˆ·æ´»åŠ¨</div>

        </div>

        <div class="findings-section">
            <h2>âš ï¸ å‘ç°çš„é—®é¢˜</h2>

            <h3>å¯ç–‘è®¡åˆ’ä»»åŠ¡</h3>
            <ul>
                <li>[*] æœç´¢å¯ç–‘çš„cronå‘½ä»¤æ¨¡å¼...</li>

            </ul>

            <h3>æ—¥å¿—å¼‚å¸¸</h3>
            <ul>
                <li>[*] æ£€æŸ¥æœ€è¿‘çš„è®¤è¯å¤±è´¥ (æœ€å50æ¡)...</li>
                <li>[*] æ£€æŸ¥æš´åŠ›ç ´è§£è¿¹è±¡ (åŒä¸€IPå¤±è´¥æ¬¡æ•°)...</li>
                <li>12æœˆ 17 17:13:42 kali kernel: Bluetooth: hci0: Opcode 0x0c12 failed: -38</li>
                <li>12æœˆ 17 17:13:55 kali gdm-password][107006]: pam_unix(gdm-password:auth): conversation failed</li>
                <li>12æœˆ 18 12:11:21 kali kernel: Bluetooth: hci0: Opcode 0x0c12 failed: -38</li>
                <li>12æœˆ 18 12:11:28 kali gdm-password][124416]: pam_unix(gdm-password:auth): conversation failed</li>
                <li>12æœˆ 18 22:23:00 kali kernel: Bluetooth: hci0: Opcode 0x0c12 failed: -38</li>

            </ul>

        </div>

        <div class="recommendations-section">
            <h2>ğŸ’¡ å»ºè®®æªæ–½</h2>
            <ul>
                <li>åˆ é™¤æˆ–ç¦ç”¨å¯ç–‘çš„è®¡åˆ’ä»»åŠ¡</li>
                <li>æ£€æŸ¥ç³»ç»Ÿå¯åŠ¨é¡¹å’ŒæœåŠ¡é…ç½®</li>
                <li>åŠ å¼ºè®¤è¯æœºåˆ¶ï¼Œä¿®æ”¹å¼±å¯†ç </li>
                <li>å¯ç”¨å¤šå› ç´ è®¤è¯</li>
                <li>é…ç½®æ—¥å¿—ç›‘æ§å’Œå‘Šè­¦</li>
                <li>ä¿å­˜æœ¬æ¬¡åº”æ€¥å“åº”çš„æ‰€æœ‰æ—¥å¿—å’Œå–è¯æ•°æ®</li>
                <li>æ›´æ–°å®‰å…¨ç­–ç•¥å’Œåº”æ€¥å“åº”é¢„æ¡ˆ</li>

            </ul>
        </div>

        <div class="footer">
            <p>æœ¬æŠ¥å‘Šç”± MCP-IRT è‡ªåŠ¨åŒ–åº”æ€¥å“åº”å·¥å…·ç”Ÿæˆ</p>
            <p>æŠ¥å‘Šç”Ÿæˆæ—¶é—´: 2025-12-20 15:07:58</p>
        </div>
    </div>
</body>
</html>
